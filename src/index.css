@import "tailwindcss";

@theme {
  /* Base Colors */
  --color-apex-black: #09090b;
  --color-apex-white: #f5f5dc;
  --color-apex-white-rgb: 245 245 220;
  
  /* Data Accent Colors */
  --color-apex-green: #3DBF6F;
  --color-apex-green-rgb: 61 191 111;
  --color-apex-cyan: #2DA8C7;
  --color-apex-orange: #E08A4C;
  --color-apex-amber: #D9B85B;
  --color-apex-red: #E35B5B;
  --color-apex-green-highlight: #247048;
  --color-apex-surface: rgba(24, 24, 27, 0.5);
  --color-apex-glass: rgba(24, 24, 27, 0.4);
  
  /* Bento Grid Design Tokens */
  --spacing-apex: 1.5rem;
  --radius-apex: 2.5rem;
  --shadow-apex-card: 0 14px 36px rgba(0, 0, 0, 0.45);
}

/* Safe Area Insets - for notches and punch-holes */
:root {
  --safe-area-inset-top: env(safe-area-inset-top, 0px);
  --safe-area-inset-right: env(safe-area-inset-right, 0px);
  --safe-area-inset-bottom: env(safe-area-inset-bottom, 0px);
  --safe-area-inset-left: env(safe-area-inset-left, 0px);
}

/* Global dark background - will be overridden by theme */
html,
body {
  background-color: var(--color-apex-black, #09090b);
  margin: 0;
  padding: 0;
}

.bg-noise {
  --apex-noise-image: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScxMjAnIGhlaWdodD0nMTIwJyB2aWV3Qm94PScwIDAgMTIwIDEyMCc+PGZpbHRlciBpZD0nbic+PGZlVHVyYnVsZW5jZSB0eXBlPSdmcmFjdGFsTm9pc2UnIGJhc2VGcmVxdWVuY3k9JzAuOCcgbnVtT2N0YXZlcz0nNCcgc3RpdGNoVGlsZXM9J3N0aXRjaCcvPjwvZmlsdGVyPjxyZWN0IHdpZHRoPScxMjAnIGhlaWdodD0nMTIwJyBmaWx0ZXI9J3VybCgjbiknIG9wYWNpdHk9JzAuMDUnLz48L3N2Zz4=");
  background-image: var(--apex-noise-image);
  background-repeat: repeat;
  background-size: 120px 120px;
}

/* Sonner Toast Styling for Apex */
[data-sonner-toast] {
  background: var(--color-apex-black, #0A0A0A) !important;
  border: 1px solid rgba(255, 255, 255, 0.2) !important;
  color: var(--color-apex-white, #f5f5dc) !important;
  font-family: inherit !important;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5) !important;
  margin-bottom: 0 !important;
  opacity: 1 !important;
  transform: translateX(0) !important;
}

/* Ensure stacked toasts maintain visibility with proper spacing */
[data-sonner-toaster] {
  --width: 356px;
  --toast-gap: 8px;
  /* Respect safe area insets for top-center positioning */
  top: calc(1rem + env(safe-area-inset-top, 0px)) !important;
  /* Ensure toasts are always on top of all content - higher than any fixed containers */
  z-index: 99999 !important;
  /* Ensure toaster portal is rendered at root level */
  position: fixed !important;
}

/* Stacking behavior - ensure each toast is visible and properly spaced */
[data-sonner-toast] + [data-sonner-toast] {
  margin-top: 8px !important;
}

/* Type-specific border colors */
[data-sonner-toast][data-type="success"] {
  border-color: var(--color-apex-green, #3DBF6F) !important;
}

[data-sonner-toast][data-type="error"] {
  border-color: var(--color-apex-red, #E35B5B) !important;
}

[data-sonner-toast] [data-description] {
  color: var(--color-apex-white, #f5f5dc) !important;
}

/* Ensure toast content is visible and properly styled */
[data-sonner-toast] [data-title] {
  color: var(--color-apex-white, #f5f5dc) !important;
  opacity: 1 !important;
  visibility: visible !important;
}

[data-sonner-toast] [data-content] {
  color: var(--color-apex-white, #f5f5dc) !important;
  opacity: 1 !important;
  visibility: visible !important;
}

/* Ensure toast text content is visible - target all possible content containers */
[data-sonner-toast] > div,
[data-sonner-toast] > div > div,
[data-sonner-toast] [data-content] > *,
[data-sonner-toast] [data-title] > * {
  opacity: 1 !important;
  visibility: visible !important;
  color: inherit !important;
}

/* Ensure toast message text is visible */
[data-sonner-toast] p,
[data-sonner-toast] span,
[data-sonner-toast] div {
  color: var(--color-apex-white, #f5f5dc) !important;
  opacity: 1 !important;
}

/* Prevent toast text overflow - wrap long messages */
[data-sonner-toast] [data-title],
[data-sonner-toast] [data-content],
[data-sonner-toast] p,
[data-sonner-toast] span {
  word-wrap: break-word !important;
  overflow-wrap: break-word !important;
  max-width: 100% !important;
  overflow: hidden !important;
  text-overflow: ellipsis !important;
  display: -webkit-box !important;
  -webkit-line-clamp: 3 !important;
  -webkit-box-orient: vertical !important;
  line-height: 1.4 !important;
}

/* Ensure toasts maintain their individual styling when stacked */
[data-sonner-toast] {
  position: relative !important;
  isolation: isolate !important;
  /* Ensure individual toasts also have high z-index - higher than any fixed containers */
  z-index: 99999 !important;
}

/* Prevent toasts from merging visually when stacked */
[data-sonner-toaster] [data-sonner-toast] {
  backdrop-filter: none !important;
}

/* Ensure numbers use font-mono in toasts */
[data-sonner-toast] .font-mono {
  font-family: 'JetBrains Mono', monospace;
}

/* Shimmer animation for skeleton loaders */
@keyframes shimmer {
  0% {
    transform: translateX(-100%);
  }
  100% {
    transform: translateX(100%);
  }
}

.animate-shimmer {
  animation: shimmer 2s infinite;
  background: linear-gradient(
    90deg,
    transparent 0%,
    transparent 40%,
    rgba(255, 255, 255, 0.1) 50%,
    transparent 60%,
    transparent 100%
  );
  background-size: 200% 100%;
}

/* Theme-aware hover border using highlight color */
.hover-border-theme {
  transition: border-color 0.2s ease;
}

.hover-border-theme:hover {
  border-color: var(--color-apex-green-highlight, rgba(36, 112, 72, 0.4)) !important;
}

/* Apex Dark Map Style - Inverts OSM tiles to dark theme */
.dark-map-tiles {
  filter: invert(100%) hue-rotate(180deg) brightness(95%) contrast(90%);
}

/* Leaflet Map Z-Index Isolation - Prevent map from appearing over modals */
/* Create a stacking context for map containers to isolate Leaflet's z-index */
.leaflet-container {
  isolation: isolate;
  position: relative;
  z-index: 1;
}

/* Ensure Leaflet controls stay within the map's stacking context */
.leaflet-control-container {
  position: relative;
  z-index: 2;
}

/* Hide Leaflet attribution control - attribution moved to Profile page */
.leaflet-control-attribution {
  display: none !important;
}

/* Allow page scrolling through non-interactive maps */
.map-non-interactive,
.map-non-interactive * {
  pointer-events: none !important;
  touch-action: pan-y !important;
}

/* Allow dragging to scroll when touching inputs in modal bodies */
.modal-scroll-body input,
.modal-scroll-body textarea,
.modal-scroll-body select {
  touch-action: pan-y;
}

/* Prevent browser autofill from applying bright background */
input:-webkit-autofill,
input:-webkit-autofill:hover,
input:-webkit-autofill:focus,
textarea:-webkit-autofill,
textarea:-webkit-autofill:hover,
textarea:-webkit-autofill:focus,
select:-webkit-autofill,
select:-webkit-autofill:hover,
select:-webkit-autofill:focus {
  -webkit-text-fill-color: var(--color-apex-white, #f5f5dc) !important;
  box-shadow: 0 0 0px 1000px var(--color-apex-black, #0A0A0A) inset !important;
  caret-color: var(--color-apex-white, #f5f5dc);
  transition: background-color 9999s ease-out 0s;
}